---
sidebar_position: 4
---

# Асинхронный метод выставления заявок

С целью уменьшить latency доставки торговых поручений до биржи в T-Invest API реализован асинхронный метод выставления заявок.

При подаче поручений асинхронным методом брокер не дожидается подтверждения от биржи об успешном статусе выставления заявки и присвоения ей биржевого номера. При работе с асинхронным методом есть ряд особенностей.

Метод позволяет выставлять поручения параллельно, не создавая очереди заявок, что возможно при работе с PostOrder.
Это позволяет ускорить работу алгоритма, распараллелив процессы.

## PostOrderAsync запрос

Входные параметры асинхронного метода идентичны [PostOrder](/invest/services/orders/methods#postorder).
При этом есть особенность — [идентификатор ключа идемпотентности](/invest/services/orders/head-orders#идентификатор-ключа-идемпотентности) **order_id** является обязательным
и должен быть передан в UUID-формате любой версии.

## PostOrderAsync ответ

### В случае ошибки

При выставлении асинхронного поручения на стороне брокера проводятся предварительные проверки, идентичные синхронному взаимодействию.

В случае ошибок валидации ответ будет идентичен [PostOrder](/invest/services/orders/methods#postorder).

### Успешное выставление заявки

Если проверки пройдены и заявка передана на биржу, вернется [ответ](/invest/services/orders/methods#postorderasyncresponse), где
**order_request_id** — ключ идемпотентности, переданный в запросе в виде **order_id**.

:::caution
В ответе метода нет биржевого идентификатора. <b>trade_intent_id</b> — внутренний идентификатор брокера.
:::

:::caution
Успешный ответ не гарантирует, что заявка будет выставлена на бирже. Биржа может отклонить заявку на своей стороне.
:::

## Получить статус торгового поручения

Получать изменения статуса торгового поручения можно через подписку на [cтрим заявок](/invest/services/orders/orders_state_stream).

**order_request_id** в сообщениях стрима соответствует **order_request_id** в ответе PostOrderAsync, **order_id** — биржевому номеру заявки.

Когда вы получили биржевой номер из стрима, дальнейшие статусы можно отслеживать через методы [GetOrderState](/invest/services/orders/methods#getorderstate)
и [GetOrder](/invest/services/orders/methods#getorders), а отменить поручение — через метод [CancelOrder](/invest/services/orders/methods#cancelorder).

Дополнительно в методы GetOrderState и CancelOrder добавлена поддержка работы по ключу идемпотентности **order_request_id**.