---
sidebar_position: 5
---

import { DocImage } from '@/components/DocImage'

# Токен

Токен — это набор символов, в котором зашифрована информация о владельце, правах доступа и другой необходимой информации для авторизации в T&#8209;Invest API. В процессе работы с T&#8209;Invest API токен нужно передавать в metadata каждого unary-запроса, а также в запросах на установление всех видов stream-соединений.

:::caution
Работать с T&#8209;Invest API без токена нельзя.
:::

## Виды токенов

В T&#8209;Invest API есть несколько видов токенов с разным набором прав — вы
можете выпустить несколько токенов для решения разных задач алгоритмической торговли или
мониторинга рынка ценных бумаг.

<ul>
<li><p><strong>Read-only token</strong> — токен для получения информации: например, состояние портфеля, расписание торгов различных торговых площадок, текущие котировки, исторические данные. С этим типом токена нельзя выставлять торговые поручения.</p>
</li>
<li><p><strong>Full-access token</strong> — токен для работы со всеми методами T&#8209;Invest API. Это основной тип токена для реальной работы с API.</p>
</li>
<li><p><strong>Transfer-access token</strong> — это full-access токен, позволяющий осуществлять переводы между счетами. Можно выпустить только с правами на все счета.</p>
</li>
<li><p><strong>Токен с доступом к конкретному счету</strong> — токен для получения доступа только к одному конкретному счету пользователя. Уровень прав доступа (readonly, full-access) также можно настроить.</p>
</li>
<li><p><strong>Sandbox token</strong> — токен для работы с <a href="/invest/intro/developer/sandbox">песочницей</a>. Песочница — это эмуляция работы торговых площадок, основанная на реальных данных, но не ведущая к изменению состава портфеля или баланса вашего счета. Токен предназначен для тестирования вашего робота и проверки работоспособности всех алгоритмов.</p>
<p>Если использовать этот токен для обычных методов и стримов, вернется ошибка.</p>
</li>
</ul>

## Получить токен

:::info
Рекомендуем управлять токенами с компьютера или ноутбука.
При работе с телефона возможна переадресация в мобильное приложение, где нет раздела по управлению токенами.

Чтобы переадресация не произошла, зажмите ссылку на экране телефона и в открывшемся меню выберите **Посмотреть страницу** или **Открыть в новой вкладке** — зависит от установленного браузера.
:::

1. Перейдите в [настройки профиля Т&#8209;Инвестиции](https://www.tbank.ru/invest/settings/) и авторизуйтесь в системе, если это требуется.

   Функция **Подтверждение сделок кодом** должна быть отключена.

   :::caution
   Сделки на сумму более 30 000 000 рублей требуют подтверждения и недоступны через API.
   :::

2. Выпустите токен T&#8209;Invest API для биржи и/или песочницы. Возможно, система попросит вас авторизоваться еще раз — это 
нужно для подключения робота к торговой платформе. 
3. Скопируйте токен и сохраните его. Токен отображается только один раз, посмотреть его позже не получится. 

   Вы можете выпускать неограниченное количество токенов.

## Срок жизни токена

Срок жизни токена — три месяца с даты последнего использования. 

Убедитесь, что ваши обращения выполняются с актуальным токеном. Если вы получили  ошибку 40003 — токен неактуальный. 

Пример ошибки:

```
"code": "40003"
"message": "authentication token is missing or invalid"
```

Токен может перестать быть актуальным, если:

- Пользователь перестал быть клиентом Т&#8209;Инвестиций.
- Пользователь завершил активные сессии для всех устройств.
- Аккаунт пользователя заблокировали.
- Карту пользователя заблокировали.
- Токен отозвали.
- Запрос с токеном от песочницы выполняется к реальному контуру.

## Отозвать токен

Отозвать токен и посмотреть список токенов T&#8209;Invest API можно
[в личном кабинете](https://id.tbank.ru/account) или на 
[странице настроек безопасности](https://www.tbank.ru/mybank/profile/security/). 

1. В [личном кабинете](https://www.tbank.ru/invest/portfolio/) перейдите в раздел **Настройки**.

   <DocImage width={700} src="/img/invest/Token-1.png" />

2. На плашке **Токены T-Bank Invest API** внизу страницы нажмите **Список токенов**.

   <DocImage width={700} src="/img/invest/Token-2.png" />

3. В блоке **Приложения, у которых есть доступ к данным для входа** выберите токен, который хотите удалить,
   и нажмите **Удалить доступ**.

   <DocImage width={700} src="/img/invest/Token-3.png" />
